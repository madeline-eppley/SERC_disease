## SERC disease analysis workflow
- I received two disease files from Calli Wise (SERC staff in CDE lab) that contained Dermo and bioeroder data for the MarineGEO project
- Three years of data (2022, 2023, and 2024) were together in the first file. After the completion of the 2025 data collection (yay!) I was sent a follow-up file with the 2025 data.
- This file contains analysis steps in R that I followed to analyze the data, as well as my thoughts/workflow, which are also heavily annotated in the R scripts
- High-quality PDFs of figures are often generated (alongside png uploads in this .md file) and are stored in the /fig folder of this repo.

### Step 1: Figure out what's present/absent in the data
The first thing to do is figure out which rivers are represented in our data, and how many data points are available for each year. This will help me make decisions about what data to keep. 

```R
#### Madeline G Eppley (MGE) data processing for marineGEO oyster disease data
## data source: Lohan Lab @ SERC
## goals: standardize data columns across 4 years of datasets, merge into 1 df, plot heatmaps of diseases
## exports: data for GLM analysis

library(readxl)
library(broom)
library(vegan)
library(nnet)
library(ggplot2)
library(viridis)
library(tidyverse)
library(patchwork)

rawfile <- "/Users/madelineeppley/Desktop/MarineGeo_OysterData_SevernSouthRhodeWest_2025.08.25.xlsx"
rawfile2025 <- "/Users/madelineeppley/Desktop/MarineGeo_OysterData_SevernSouthRhodeWest_2025.11.19.xlsx"

# read in data but just do 2022-2024 since there is no bioeroder data for 2021
data_2022 <- read_excel(rawfile, sheet = "RawData_2022")
data_2023 <- read_excel(rawfile, sheet = "Data2023")
data_2024 <- read_excel(rawfile, sheet = "Data2024")
data_2025 <- read_excel(rawfile2025, sheet = "Data")

# 2022 data has some samples from the Rhode river, but we don't have these for 2023 or 2024
# it looks like there is some Rhode data from 2025, let's check
sum(grepl("Rhode", data_2025$River)) #30 data points
sum(grepl("Rhode", data_2022$River)) #30 data points
sum(grepl("Rhode", data_2023$River)) #0 data points
sum(grepl("Rhode", data_2024$River)) #0 data points

# let's compare that to the number of datapoints we have for other rivers in other years?
sum(grepl("Severn", data_2025$River)) #151
sum(grepl("Severn", data_2024$River)) #31
sum(grepl("Severn", data_2023$River)) #28 
sum(grepl("Severn", data_2022$River)) #30 

# we may have a scaling issue with the number of data points per year .. but for now let's get rid of the Rhode data and we will think about the scaling later
counts_2022 <- as.data.frame(table(data_2022$River))
colnames(counts_2022) <- c("River", "Count")

counts_2023 <- as.data.frame(table(data_2023$River))
colnames(counts_2023) <- c("River", "Count")

counts_2024 <- as.data.frame(table(data_2024$River))
colnames(counts_2024) <- c("River", "Count")

counts_2025 <- as.data.frame(table(data_2025$River))
colnames(counts_2025) <- c("River", "Count")

# let's make one composite figure
p22 <- ggplot(counts_2022, aes(x = River, y = Count)) +
  geom_bar(stat = "identity", fill = "#6baed6") +
  labs(title = "2022",
       x = "River",
       y = "Individuals") +
  theme_minimal()

p23 <- ggplot(counts_2023, aes(x = River, y = Count)) +
  geom_bar(stat = "identity", fill = "#0c2c84") +
  labs(title = "2023",
       x = "River",
       y = "Individuals") +
  theme_minimal()

p24 <- ggplot(counts_2024, aes(x = River, y = Count)) +
  geom_bar(stat = "identity", fill = "#c7e9b4") +
  labs(title = "2024",
       x = "River",
       y = "Individuals") +
  theme_minimal()

p25 <- ggplot(counts_2025, aes(x = River, y = Count)) +
  geom_bar(stat = "identity", fill = "mediumblue") +
  labs(title = "2025",
       x = "River",
       y = "Individuals") +
  theme_minimal()

# arrange plot
(p22 | p23) / (p24 | p25)
```

### Data points per year, per river
The figure generated by the above code script is below:

<img width="853" height="853" alt="image" src="https://github.com/user-attachments/assets/6d4c7139-b161-4e0b-bb08-3957ea6fa2e8" />

